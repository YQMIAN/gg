<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            #div1{height: 200px; width:100%; display: flex; margin: 50px 20px;;}
            h3{text-align:  center;}
            #img2{margin-left: 10px;}
             #pp{text-align: center;}
            #bt2{ margin-left: 260px;}
            #bt3{ margin-left: 100px;}
        </style>
    </head>
    <body>
       <div id="div1">
                <img src="image/cqc.jpg" height="100%"/>
                <h3>如果你想要寻找一座安逸的城市，去找寻难得的慢生活，那就来成都吧。 这个被称为“天府之国”的城市，有着“最具幸福感城市的称号”。而且成都的旅游成本并不高，不用花多少钱就可以收获到成倍的快乐。成都有哪些值得去的地方呢？今天就带大家了解一下。

【武侯祠，圆你心中的三国梦】

听到“武侯”这个名号，想必看过三国的人们一定不会陌生，没错这便是大名鼎鼎的诸葛亮的别名“诸葛武侯”。如果你在《三国演义》中最喜欢的是蜀国，这里绝对是你必须要来看看的地方了，一定可以满足你所有的渴望。

</h3>
                
            </div>
        <div id="div1">
                <img src="image/cqc4.jpg" height="100%"/>
                <h3>锦里是成都市内非常传统的仿古街区，因其毗邻武侯祠，所以这里便有着浓浓的三国韵味。这里一年四季的都很热闹，无论什么时候来这里都是熙熙攘攘的人群摩肩接踵，国人老外尘外之人的混杂，各色特色的成都小吃的气味交织弥漫，琳琅满目的商品，三国人物的京剧玩偶形象，站在茶馆门口变脸的街头艺人，眼前的这一切就构成了锦里的当初今世的跨越时空的穿梭。不得不说这里成了老成都的高度缩影，锦里的地方不大，但是每天却是热闹非凡。兔头、钵钵鸡、张飞牛肉带着浓郁的川渝的红色真的让人垂涎欲滴。入夜后的锦里更是人潮涌动，暗香浮动，水榭亭台之间的灯光烘托出这里的古典气烟火味儿，来这里的人不急着去工作，也没有忙着去做什么事情，只有与商家讨价还价的叫卖声，茶社里热闹非凡的京剧演唱声，这一切都是最传统的老成都的氛围，在夜色迷茫中融入其中，感受成都巴适的热闹氛围。
</h3>
                
            </div>
        <div id="div1">
                <img src="image/cqc3.jpg" height="100%"/>
                <h3>【宽窄巷子，在纵深间品味成都】

宽窄巷子可以说是成都最著名的一个景点了，整个景点就是老成都的三条巷子：宽巷子、窄巷子、井巷子。整个景点是由老成都的古建筑改建而成，反映的是老成都百姓生活的缩影。现在这里已经充满了各种各样的小商店铺，可以吃到成都有名的三大炮，还能找个茶馆喝喝茶聊聊天，或者享受一下成都的特色服务掏耳朵，抑或是看一场川剧表演都是不错的选择。据老一辈的成都人说，有了成都，就有了宽窄巷子，味道从来就没有变过。青砖、青瓦，在成都的岁月里浮浮沉沉，也记录下了这座城市百年的故事。清朝康熙年间准噶尔生乱，皇上派兵镇压，平乱之后留下了千余名官兵驻守在成都，建立起了官兵生活的满城，这就是宽窄巷子的前身。历史风月飘零的研磨，后来只剩下宽窄巷子的轮廓。经过改造，这里不仅可以看到老建筑的遗迹，还可以品咂到成都人的慢生活。

</h3>
                
            </div>
     <div id="pp">
            <scan>用户评价：</scan><input type="button" class="flowerBtn hvr-grow" onclick="presentGift('yyLive','flower',this)" value="很棒！" id="bt1"/><span>0</span><br>
            <input type="button" class="eggBtn hvr-grow" onclick="presentGift('yyLive','egg',this)" value="不好！" id="bt2"/><span>0</span><a href="gl.html"><input type="button" value="返回上一页" id="bt3"/></a>
        </div>
        <script>
			var dbName="LiveBroadcast1";	//数据库名
			var dbVersion=1;			//版本号
			var storeName="channelStore";//数据仓库名称
			var connection=null;		//数据库连接
			
			//1.获取IDBFactory对象，作为数据库的操作入口
			var indexedDB = window.indexedDB || window.webkitIndexedDB || window.mozIndexedDB || window.msIndexedDB;
			//使用以下语句删除原来的数据库
//			indexedDB.deleteDatabase(dbName);
			//数据库初始化
			function init(){
				//2.获取IDBRequest对象，用于创建数据库连接的请求
				var dbRequest=indexedDB.open(dbName,dbVersion);
				dbRequest.onsuccess=function(event){
					//3.在数据库连接成功时，获取连接成功时的数据库连接对象，对象类型为IDBDatabase类型
					connection=event.target.result;
					console.log("数据库连接成功。");
					loadGiftData();
				};
				dbRequest.onerror=function(event){
					console.log('数据库连接失败！');
				};
				dbRequest.onupgradeneeded=function(event){
					connection=event.target.result;
					if(!connection.objectStoreNames.contains(storeName)){
						var optionalParameters={
							keyPath:"id",
							autoIncrement:true
						};
			           var objectStore=connection.createObjectStore(storeName,optionalParameters);
			           objectStore.createIndex('channelIndex','channel',{unique:true}); 
					  console.log("对象仓库创建成功！");			
			        }
					var tx=event.target.transaction;
					console.log("数据库版本更新成功！版本"+event.oldVersion+"=>版本"+event.newVersion);
				};
			}
			//加载Indexdb数据库中的数据
			function loadGiftData(){
				var nodeList=document.getElementsByTagName("dl");
				//4.创建一个只读事务，数据的操作放在事务中进行处理
				var tx=connection.transaction(storeName,'readonly'); 
				//5.获得数据仓库对象（相当于关系数据库中的表）
				var objectStore= tx.objectStore(storeName); 
				//6.获得IDBCursor游标
				var query=objectStore.openCursor();
				//7.通过移动游标来遍历查询的结果集
				query.onsuccess=function(event){
					var cursor=event.target.result;
					if(cursor){
						var data=cursor.value;
						for(var i in nodeList){
							if(nodeList[i].id==data.channel){
								var spanList=nodeList[i].getElementsByTagName("span");
								spanList[0].innerHTML=data.flowerNum;
								spanList[1].innerHTML=data.eggNum;
							}
						}
						cursor.continue();
					}
				}
			}
			//送鲜花、扔鸡蛋操作
			function presentGift(channel,type,object){
				//4.创建一个读写事务，数据的操作放在事务中进行处理
				var tx=connection.transaction(storeName,'readwrite');
				//5.获得数据仓库对象（相当于关系数据库中的表）
				var objectStore= tx.objectStore(storeName); 
				//6.获得IDBCursor游标
				var query=objectStore.openCursor();
				//7.通过游标来改变数据
				query.onsuccess=function(event){
					var cursor=event.target.result;
					try{
						//当记录存在时，对数据进行更新
						var num=0;
						if(cursor&&cursor.value.channel==channel){
							var data=cursor.value;
							if(type=="flower"){
								data.flowerNum=data.flowerNum+1;
								num=data.flowerNum;
							}else{
								data.eggNum=data.eggNum+1;
								num=data.eggNum;
							}
							cursor.update(data);
							object.nextSibling.innerHTML=num;
							return;
						}else if(cursor){
							cursor.continue();
						}else{
							//当记录不存在时，插入一条新纪录
							var flowerNum=0,eggNum=0;
							num=1;
							if(type=="flower"){
								flowerNum=1;
							}else{
								eggNum=1;
							}
							var data={
								channel:channel,
								flowerNum:flowerNum,
								eggNum:eggNum
							}
							objectStore.put(data);
							object.nextSibling.innerHTML=num;
							return;
						}
					}finally{
						cursor=null;
					}
				}
			}
			window.onload=init;
		</script>
    </body>
</html>
